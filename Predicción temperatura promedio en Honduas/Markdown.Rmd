---
title: "Predicción de la temperatura promedio en Honduras"
author: "Andrés Dala"
date: "1/11/2021"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(
  fig.align = "center")
```

# Introducción

Uno de los ámbitos principales de estudio en las series temporales es la variación del clima. A continuación se predecirá la temperatura promedio en Honduras para el año 2014, esto será utilizando la Metodología de predicción con Modelos SARIMA Bayesianos. El conjunto de datos a a estudiar fue extraido de [BERKELEY EARTH](http://berkeleyearth.org/data/), el cual muestra la temperatura promedio del pais desde 1980 hasta 2013. En este estudio se propondrán dos modelos distintos elegidos en base al comportamiento observado en los datos y un modelo generado por la función <code>auto.sarima</code> del paquete **bayesforecast**.

```{r, message=FALSE}
library(forecast)
library(fpp3)
library(bayesforecast)
library(bayesplot)
options(mc.cores = parallel::detectCores())
```

Se extraerán únicamente los datos de Honduras desde 1980:

```{r}
datos<-read.csv("LandTemperature.csv")

#datos<-read.csv("https://raw.githubusercontent.com/Andres-Dala/Seminario_de_Investigacion_MM700/main/Predicci%C3%B3n%20temperatura%20promedio%20en%20Honduas/LandTemperature.csv")

honduras<-datos %>%
  filter(Country == "Honduras")

honduras$dt<-as.Date(honduras$dt)
honduras <- honduras %>%
  filter(as.numeric(format(dt,"%Y"))>=1980)
honduras <- honduras %>%
  select(dt, AverageTemperature)

serie<-ts(honduras$AverageTemperature, frequency = 12, start = 1980)
```

El 95% de los datos serán de entrenamiento:

```{r}
train = head(serie, round(length(serie) * 0.95))
h = length(serie) - length(train)
test = tail(serie, h)
```

```{r, fig.width=9, fig.height=4}
autoplot(object = train, main = "Temperatura promedio en Honduras", ylab="Celsius", xlab = "Años")
```

```{r}
as_tsibble(train) %>%
  gg_season(value , labels = "both") +
  labs(x = "Meses", y = "Celsius", title = "Grafico estacional")
```

```{r}
k1<-autoplot(object = train, y = "Celsius", x = "Años")
k2<-autoplot(object = diff(train,12),y = "Celsius", x = "Años")
k3<-autoplot(object = diff(diff(train,12)), y = "Celsius", x = "Años")

gridExtra::grid.arrange(k1,k2,k3, ncol = 1)
```

```{r}
g2 = ggacf(y = diff(diff(train,12)))
g3 = ggpacf(y = diff(diff(train,12)))

gridExtra::grid.arrange(g2,g3, nrow = 2)
```

Los modelos elegidos son:

## Modelo 1
$$
 Temperatura \sim SARIMA(2,1,2)_\times(2,1,0)_{12}\\
 \mu_0 \sim t(0,2.5,7)\\
 \sigma_0 \sim t(7)\\
 ar_1, ma_1 \sim N(0,0.5)\\
 sar_1,sma_1 \sim N(0,0.5)
$$


## Modelo 2

$$
 Temperatura \sim SARIMA(1,1,0)_\times(1,1,1)_{12}\\
 \mu_0 \sim t(0,2.5,7)\\
 \sigma_0 \sim t(7)\\
 ar_1, ma_1 \sim beta(2,2)\\
 sar_1,sma_1 \sim beta(2,2)
$$

## Modelo 3

```{r}
model3<-auto.sarima(train)
prior_summary(model3)
```




